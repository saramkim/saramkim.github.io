{"componentChunkName":"component---src-templates-post-template-tsx","path":"/GarbageCollection/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>자바스크립트 엔진(V8)은 자바스크립트 코드를 컴파일 및 실행하고, 메모리를 자체 관리합니다.</p>\n<p><a href=\"https://saramkim.github.io/Thread&#x26;EventLoop/\" target=\"_blank\" rel=\"nofollow\">이벤트 루프</a>, <a href=\"https://saramkim.github.io/ExecutionContext/\" target=\"_blank\" rel=\"nofollow\">실행 컨텍스트</a>에 이어 자바스크립트 엔진의 메모리 관리, Garbage Collection과 Closure에 관한 정보를 정리하였습니다.</p>\n<p>전체적인 흐름을 이해하기 위한 내용이라 생략된 개념이 존재합니다.</p>\n<p>혹 틀린 부분이 있다면 댓글 부탁드립니다.</p>\n<hr>\n<h4>메모리 생존 주기</h4>\n<ol>\n<li>\n<p>메모리 <strong>할당</strong>: 실행 컨텍스트의 생성 단계에서 이루어지는 과정입니다. (<a href=\"https://saramkim.github.io/ExecutionContext/\" target=\"_blank\" rel=\"nofollow\">실행 컨텍스트</a> 참조)</p>\n</li>\n<li>\n<p>메모리 <strong>사용</strong>: 실행 컨텍스트의 실행 단계에서 이루어지는 과정입니다. 할당된 메모리를 읽고 쓰는 것을 의미합니다.</p>\n</li>\n<li>\n<p>메모리 <strong>해제</strong>: 할당된 메모리가 더 이상 사용되지 않을 때, Garbage Collection을 통해 메모리를 해제합니다.</p>\n</li>\n</ol>\n<br>\n<h4>메모리 구조</h4>\n<p>V8의 메모리는 크게 스택 영역과 힙 영역으로 나뉩니다.</p>\n<ul>\n<li>\n<p>스택(Stack): <strong>원시 타입</strong>의 값과 객체를 가리키는 <strong>포인터</strong>와 같은 <strong>정적 데이터</strong>를 저장합니다.</p>\n</li>\n<li>\n<p>힙(Heap): <strong>참조 타입</strong>의 값과 같은 <strong>동적 데이터</strong>를 저장합니다.</p>\n</li>\n</ul>\n<br>\n<h4>Garbage Collection</h4>\n<p>V8은 내장된 Garbage Collection(이하 GC)을 이용해 더 이상 <strong>사용하지 않는 메모리를 탐지하고 해제</strong>하여 메모리를 자체 관리합니다.</p>\n<p>이를 위해 메모리 사용 상황을 계속 모니터링하면서 <strong>도달 가능성이 없는 객체</strong>를 탐지하는데, 이때 <a href=\"https://www.geeksforgeeks.org/mark-and-sweep-garbage-collection-algorithm/\" target=\"_blank\" rel=\"nofollow\">Mark-and-Sweep</a> 알고리즘을 사용합니다.</p>\n<p>또한, V8의 메인 스레드(코드를 실행하는 스레드)는 단일 스레드이기 때문에 별개의 스레드에서 GC를 수행하여 블로킹을 줄입니다.</p>\n<br>\n<h4>과정</h4>\n<ol>\n<li>\n<p>초기 마크: root 객체들을 찾아서 마크합니다. root 객체는 전역 객체나 현재 실행 컨텍스트의 지역 변수를 말합니다.</p>\n</li>\n<li>\n<p>동시 마크: 메인 스레드에서 실행 중인 자바스크립트 코드를 간섭하지 않고, 마크되지 않은 객체들을 마크합니다.</p>\n</li>\n<li>\n<p>스왑: 메인 스레드와 스왑하여, 메인 스레드에서 변경된 참조 관계를 GC 스레드에서 사용할 수 있도록 합니다.</p>\n</li>\n<li>\n<p>초기 스윕: 마크되지 않은 객체들을 메모리에서 해제합니다. 이 과정에서 메인 스레드에서 변경된 참조 관계가 반영됩니다.</p>\n</li>\n<li>\n<p>동시 스윕: 메인 스레드에서 실행 중인 자바스크립트 코드에서 객체를 생성하거나 참조를 해제하면, 이를 감지하고 동시 스윕을 하여 메모리를 해제합니다.</p>\n</li>\n</ol>\n<br>\n<h4>Closure</h4>\n<p>클로저는 반환된 내부 함수가 자신이 <strong>선언된 스코프를 기억</strong>하여 밖에서 호출되어도 선언 스코프에 접근할 수 있는 함수를 말합니다.</p>\n<p>보통 실행 컨텍스트가 콜 스택에서 제거되면 GC로 인해 해당 환경의 데이터 메모리는 모두 해제됩니다.</p>\n<p>하지만 <u>클로저 외부 함수의 경우</u>, 실행 컨텍스트가 콜 스택에서 제거되어도 해당 환경의 메모리가 해제되지 않습니다.</p>\n<p>그렇게 참조 가능한 외부 함수의 변수를 자유변수(Free variable)라고 합니다.</p>\n<hr>\n<h3>참고 링크</h3>\n<ul>\n<li>\n<p><a href=\"https://developer.mozilla.org/ko/docs/Web/JavaScript/Memory_Management\" target=\"_blank\" rel=\"nofollow\">자바스크립트의 메모리 관리</a></p>\n</li>\n<li>\n<p><a href=\"https://medium.com/sessionstack-blog/how-javascript-works-memory-management-how-to-handle-4-common-memory-leaks-3f28b94cfbec\" target=\"_blank\" rel=\"nofollow\">How JavaScript works: memory management + how to handle 4 common memory leaks</a></p>\n</li>\n<li>\n<p><a href=\"https://felixgerschau.com/javascript-memory-management/\" target=\"_blank\" rel=\"nofollow\">JavaScript’s Memory Management Explained</a></p>\n</li>\n<li>\n<p><a href=\"https://blog.bitsrc.io/memory-leaks-in-nodejs-54ac7bbd4173\" target=\"_blank\" rel=\"nofollow\">Understanding Memory Leaks in Nodejs</a></p>\n</li>\n<li>\n<p><a href=\"https://yceffort.kr/2020/12/javascript-garbage-collection\" target=\"_blank\" rel=\"nofollow\">자바스크립트의 가비지 컬렉션</a></p>\n</li>\n<li>\n<p><a href=\"https://poiemaweb.com/js-closure\" target=\"_blank\" rel=\"nofollow\">클로저</a></p>\n</li>\n</ul>","frontmatter":{"title":"JavaScript Garbage Collection","summary":"자바스크립트 가비지 컬렉션과 클로저에 관하여","date":"2023.03.20.","categories":["JS"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABBklEQVQoz52SMUsDQRCFVy2EVEJia5NfYmthY2VnoUUKrcTGUkQsTOFP0DRaaC/YKoLYaCPRBBGRoEY9Yu64nZ1PvEQ00T24PBhmYed9O7DP8I9UtdsdqravpGemXwaPfIbvh3wyaQYXXWKDCjbYTyp+30Xap6lQD9AmPX5Z56M6QljLE9ULxPUh4sZ8z0w2YLNMWCsQVIu8XRe5Px+j/bg0ODB63oLGOBdHEyyX8qyUhmk9LHZm3EAbbhDejLK9lmNzNcfCrOHseC65E8kEFL7+WFt7vN5OcViZ5upkhoOdSZ7uyt0NJVtsQPElJy1SxmfoeDQ5iyjOKVb0V+g1G/AH/LfSgJ9H1UgnE7LTsQAAAABJRU5ErkJggg=="},"images":{"fallback":{"src":"/static/c6353991827688bbdcebbe960ab5d369/d2355/js.png","srcSet":"/static/c6353991827688bbdcebbe960ab5d369/e8fbe/js.png 175w,\n/static/c6353991827688bbdcebbe960ab5d369/c0907/js.png 350w,\n/static/c6353991827688bbdcebbe960ab5d369/d2355/js.png 700w","sizes":"(min-width: 700px) 700px, 100vw"},"sources":[{"srcSet":"/static/c6353991827688bbdcebbe960ab5d369/b1534/js.webp 175w,\n/static/c6353991827688bbdcebbe960ab5d369/659a6/js.webp 350w,\n/static/c6353991827688bbdcebbe960ab5d369/c4944/js.webp 700w","type":"image/webp","sizes":"(min-width: 700px) 700px, 100vw"}]},"width":700,"height":400}},"publicURL":"/static/c6353991827688bbdcebbe960ab5d369/js.png"}}}}]}},"pageContext":{"slug":"/GarbageCollection/","next":null,"prev":{"fields":{"slug":"/ExecutionContext/"},"frontmatter":{"title":"JavaScript Execution Context"}}}},"staticQueryHashes":[]}